# 开篇词

## To Be a HTTP Hero



# 破冰篇

## 时势与英雄：HTTP的前世今生

讲解了HTTP发展的趋势 从HTTP 0.9到HTTP1.0（不作为正式使用）到HTTP1.1 （现在主流）到HTTP2 （2014产生）到HTTP3（QUIC协议推动发展） HTTP2和HTTP3主要是由谷歌需求推动协议发展。

### **HTTP0.9** 

1. 采用纯文本形式
2. 只允许使用GET获取资源，获得后就断开连接

### **HTTP1.0**

1. 增加了 HEAD、POST 等新方法；
2. 增加了响应状态码，标记可能的错误原因；
3. 引入了协议版本号概念；
4. 引入了 HTTP Header（头部）的概念，让 HTTP 处理请求和响应更加灵活；
5. 传输的数据不再仅限于文本。

### **HTTP1.1** 

1. 增加了 PUT、DELETE 等新的方法；
2. 增加了缓存管理和控制；
3. 明确了连接管理，允许持久连接；
4. 允许响应数据分块（chunked），利于传输大文件；
5. 强制要求 Host 头，让互联网主机托管成为可能。

> 缓存管理和控制：当浏览器获得资源后，服务器回传资源有效时间，浏览器将参数放在Cache-Control中下次请求时判断缓存是否过期再次请求	

### **HTTP2**

1. 二进制协议，不再是纯文本；
2. 可发起多个请求，废弃了 1.1 里的管道；
3. 使用专用算法压缩头部，减少数据传输量；
4. 允许服务器主动向客户端推送数据；
5. 增强了安全性，“事实上”要求加密通信。

### **HTTP3** 





## HTTP是什么？HTTP又不是什么？



HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。



## HTTP世界全览（上）：与HTTP相关的各种概念

![image-20200424162001087](https://pic-go-youdaoyun-image.oss-cn-beijing.aliyuncs.com/pic-go-youdaoyun-image/20200424162002.png)



1. 互联网上绝大部分资源都使用 HTTP 协议传输；
2. 浏览器是 HTTP 协议里的请求方，即 User Agent；
3. 服务器是 HTTP 协议里的应答方，常用的有 Apache 和 Nginx；
4. CDN 位于浏览器和服务器之间，主要起到缓存加速的作用；
5. 爬虫是另一类 User Agent，是自动访问网络资源的程序。



## HTTP世界全览（下）：与HTTP相关的各种协议

![image-20200424162946245](https://pic-go-youdaoyun-image.oss-cn-beijing.aliyuncs.com/pic-go-youdaoyun-image/20200424162947.png)

因为 HTTPS 相当于“HTTP+SSL/TLS+TCP/IP”，其中的“HTTP”和“TCP/IP”我们都已经明白了，只要再了解一下 SSL/TLS，HTTPS 也就能够轻松掌握。

SSL 的全称是“**S**ecure **S**ocket **L**ayer”，由网景公司发明，当发展到 3.0 时被标准化，改名为 TLS，即“**T**ransport **L**ayer **S**ecurity”，但由于历史的原因还是有很多人称之为 SSL/TLS，或者直接简称为 SSL。

SSL 使用了许多密码学最先进的研究成果，综合了对称加密、非对称加密、摘要算法、数字签名、数字证书等技术，能够在不安全的环境中为通信的双方创建出一个秘密的、安全的传输通道，为 HTTP 套上一副坚固的盔甲。

### **代理的作用**

1. 负载均衡：把访问请求均匀分散到多台机器，实现访问集群化；
2. 内容缓存：暂存上下行的数据，减轻后端的压力；
3. 安全防护：隐匿 IP, 使用 WAF 等工具抵御网络攻击，保护被代理的机器；
4. 数据处理：提供压缩、加密等额外的功能。





## 常说的“四层”和“七层”到底是什么？“五层”“六层”哪去了？

TCP是有状态的协议，发送数据前双方必须建立连接，由此可以保证传输字节流 是连续的而且没有重复。UDP是没有状态的协议，发送前不需要建立连接。UDP发送的数据包是无序的，且乱序收的。

CDN处于应用层 （一开始以为处于网络层，果然对于请求处理层数越少越好）





## 域名里有哪些门道

1. 域名使用字符串来代替 IP 地址，方便用户记忆，本质上一个名字空间系统；
2. DNS 就像是我们现实世界里的电话本、查号台，统管着互联网世界里的所有网站，是一 个“超级大管家”； 
3. DNS 是一个**树状的分布式查询系统**，但为了提高查询效率，外围有多级的缓存； 
4.  使用 DNS 可以实现基于域名的负载均衡，既可以在内网，也可以在外网。

DNS域名解析的过程可以分别为本地host文件-> 本地域名服务器->根域名服务器->权威域名服务器

外围有多级缓存为大公司为了加速域名解析，会创建自己的DNS域名服务器，非权威域名服务器。作为用户DNS查询的代理，代替用户访问核心DNS。如同谷歌创建的8.8.8.8免费公共域名服务器。



## 自己动手，搭建HTTP实验环境

配置实验环境 ，同时安装了wireshak以及openresty 



# 基础篇

## 键入网址再按下回车，后面究竟发生了什么？

再简要叙述一下这次最简单的浏览器 HTTP 请求过程：

1. 浏览器从地址栏的输入中获得服务器的 IP 地址和端口号；
2. 浏览器用 TCP 的三次握手与服务器建立连接；
3. 浏览器向服务器发送拼好的报文；
4. 服务器收到报文后处理请求，同样拼好报文再发给浏览器；
5. 浏览器解析报文，渲染输出页面。

![image-20200424221950118](https://pic-go-youdaoyun-image.oss-cn-beijing.aliyuncs.com/pic-go-youdaoyun-image/20200424221951.png)



## HTTP报文是什么样子的？



















































